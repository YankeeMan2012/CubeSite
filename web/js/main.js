window.onload=function(){AppJS.ready()};var AppJS={ready:function(){AppJS.handlers(),AppJS.sliderInit(),AppJS.deviceDetect(),AppJS.calculateSum(),AppJS.initMask($("[data-mask]")),$(".customScroll").mCustomScrollbar({scrollInertia:200,theme:"dark",scrollbarPosition:"outside"})},handlers:function(){$(".choiceMethod .methodItem").on("click",function(){AppJS.callMethod($(this))}),$(".showCallBack").on("click",function(){AppJS.switchCallBack()}),$(".callBackForm button").on("click",function(e){AppJS.ajaxSubmit(e,$(this))}),$(".gibBtn, .up").on("click",function(){$(".wrapper").toggleClass("rotate")}),$(".changeControl").on("click",function(e){AppJS.changeControl(e,$(this))}),$(".status").on("click",function(){AppJS.changeItem($(this)),AppJS.calculateSum()}),$(".changeItem button").on("click",function(){AppJS.changeBtn($(this)),AppJS.calculateSum()}),$(".openPf").on("click",function(){$(".portfolio").addClass("pfShow")}),$(".pfClose").on("click",function(){$(".portfolio").removeClass("pfShow")}),$(".openAbout").on("click",function(){$(".about").addClass("showModal")}),$(".openRecall").on("click",function(){$(".recall").addClass("showModal")}),$(".overlay, .closeModal").on("click",function(){AppJS.hideModal()}),$(".calculate, .pubInput, .logoField").on("keypress",function(e){AppJS.onlyPattern(e,$(this))}),$(".calculate, .pubInput, .logoField").on("input",function(){AppJS.calculateSum()}),$(".duplicate").on("input",function(){AppJS.duplicate($(this))}),$(".pubInput, .logoField").on("input",function(){AppJS.copyToDuplicate($(this))}),$("#select").on("change",function(){AppJS.calculateSum()}),window.onresize=function(){AppJS.deviceDetect()},$("[data-required]").on("focusout",function(){ValidForm.checkRequiredVal(this)}),$("[data-pattern]").on("focusout",function(){ValidForm.checkFieldToPattern(this)})},onlyPattern:function(e,a){var t=a.val()+String.fromCharCode(e.charCode),i=/^[0-9]*$/.test(t);(!i||t.length>5)&&e.preventDefault()},initMask:function(e){var a=e.attr("data-mask");e.mask(a)},hideModal:function(){$(".show, .pfShow, .modalWrap").removeClass("show pfShow showModal")},ajaxSubmit:function(e,a){e.preventDefault();var t=ValidForm.validateField(a.siblings(".submitField"));if(t){var i=a.closest("form").serializeArray(),l=$(".preLoader");l.show(),$.post("/mail.php",i,function(){AppJS.switchCallBack(),l.hide()})}},sliderInit:function(){var e=Math.round($(".pfSlide").length/2)-1,a=new Swiper(".pfSlider",{slidesPerView:"auto",centeredSlides:!0,spaceBetween:-180,nextButton:".swiper-next",prevButton:".swiper-prev",initialSlide:e,loop:!0,breakpoints:{400:{spaceBetween:-50},650:{spaceBetween:-120}}});AppJS.sliderLevel(),a.on("SlideChangeStart",function(){AppJS.sliderLevel()}),new Swiper(".recall",{slidesPerView:1,loop:!0,speed:1e3,spaceBetween:300,nextButton:".nextSlide",prevButton:".prevSlide",centeredSlides:!0}),new Swiper(".textSlider",{slidesPerView:"auto",autoplay:2e3,loop:!0,speed:2e3})},sliderLevel:function(){$(".pfSlide").removeClass("level3 level4 level5");var e=$(".swiper-slide-next").next(),a=$(".swiper-slide-prev").prev(),t=e.next(),i=a.prev(),l=t.next(),s=i.prev();e.add(a).addClass("level3"),t.add(i).addClass("level4"),l.add(s).addClass("level5")},changeBtn:function(e){var a=e.closest(".changeItem").find(".status"),t=e.closest(".question"),i=a.closest(".questionBox"),l=t.hasClass("onlinePay");e.hasClass("ok")?(l&&t.removeClass("noPay").addClass("pay"),e.closest(".design").find(".active").removeClass("active")):e.hasClass("no")&&l&&t.removeClass("pay").addClass("noPay"),i.removeClass("showQuestion"),setTimeout(function(){i.addClass("showQuestion")},10)},callMethod:function(e){var a=e.attr("data-target"),t=e.closest(".choiceMethod").find(".methodItem"),i=e.closest(".callBack").find("form");t.removeClass("active"),e.addClass("active"),i.attr("id","method"+(e.closest(".methodWrap").index()+1)),i.find("input").removeAttr("name").removeClass("submitField").val(""),i.find("."+a).attr("name",a).addClass("submitField"),ValidForm.removeInvalid(i.find("."+a))},changeControl:function(e,a){$(e.target).closest(".question").length||($(".designType").removeClass("checked active"),a.addClass("checked active"),AppJS.calculateSum())},changeItem:function(e){var a=e.closest(".changeItem");a.find(".onlinePay").removeClass("pay noPay"),e.toggleClass("checked noChecked"),a.hasClass("questionBox")&&a.toggleClass("showQuestion")},switchCallBack:function(){$(".callBack").toggleClass("show")},copyToDuplicate:function(e){var a=e.val(),t=$("."+e.attr("data-duplicate"));t.val(a)},duplicate:function(e){var a=e.val(),t=$("."+e.attr("data-real"));t.val(a)},calculateSum:function(){var e=$(".price span"),a=$(".deadline span"),t=0,i=0,l=$(".adaptive");if(l.hasClass("checked")){var s=l.attr("data-key");i+=params[s].time,t+=params[s].price}var o=$("#select").val();i+=params.engine[o].time,t+=params.engine[o].price;var n=$(".calculate");n.each(function(){var e=$(this).closest(".changeItem"),a=e.find(".status"),l=e.find(".individual");if(a.hasClass("checked")||$(this).hasClass("pageNum")&&l.hasClass("checked")){var s=e.attr("data-key"),o=+$(this).val();i+=params[s].time*o,t+=params[s].price*o}});var c=$(".pubInput"),r=c.closest(".publication"),d=r.attr("data-key"),p=r.find(".publicNum").val(),u=r.find(".words").val();if(r.find(".status").hasClass("checked")){var v=+p*(+u/1e3);i+=params[d].time*v,t+=params[d].price*v}var h=$(".logoField"),m=h.closest(".logotype"),f=m.attr("data-key"),S=+m.find(".devLogo").val();m.find(".status").hasClass("checked")&&(i+=params[f].time*S,t+=params[f].price*S);var C=$(".status.checked:not(.noCalculate)");C.each(function(){var e=$(this).attr("data-key");i+=params[e].time,t+=params[e].price});var g=$(".onlinePay.pay");if(g.length){var k=g.attr("data-key");i+=params[k].time,t+=params[k].price}isNaN(t)||e.text(Math.round(t)+" руб."),isNaN(i)||a.text(Math.round(i)+" дней.")},deviceDetect:function(){var e=detect.parse(navigator.userAgent),a=e.device.family,t=e.os.family;AppJS.isBadBrowser="iPhone"===a||"iPad"===a||"iOS"===t,AppJS.appleStyle()},appleStyle:function(){var e=$("body"),a=$(".cube, .side");if(AppJS.isBadBrowser){var t=window.innerHeight;e.addClass("apple"),a.css({height:t})}else e.removeClass("apple"),a.css({height:"100vh"})}},ValidForm={patterns:{email:/^\w+([\.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,4})+$/,skype:/^[a-zA-Z][a-zA-Z0-9\._-]{5,31}$/,whatsapp:/^[a-zA-Z][a-zA-Z0-9\._-]{5,31}$/},message:{emptyField:"Поле не может быть пустым",email:"Неверный формат Email",skype:"Неверный формат Skype",whatsapp:"Неверный формат WhatSapp"},getError:function(e){return'<p class="error">'+e+"</p>"},checkRequiredVal:function(e){var a=$(e).closest(".callBackForm");if(ValidForm.removeInvalid(e),""===$(e).val().trim()){var t=ValidForm.getError(ValidForm.message.emptyField);a.addClass("invalid").append(t)}},checkFieldToPattern:function(e){var a=$(e).closest(".callBackForm"),t=$(e).attr("data-pattern");if(!$(e).val())return!1;if(ValidForm.patterns[t].test($(e).val()))ValidForm.removeInvalid(e);else if(!a.hasClass("invalid")){var i=ValidForm.getError(ValidForm.message[t]);a.addClass("invalid").append(i)}},removeInvalid:function(e){$(e).closest(".invalid").removeClass("invalid").find("p.error").remove()},validateField:function(e){var a=!0;return ValidForm.removeInvalid(e),e.focusout(),e.closest(".invalid").length&&(a=!1),a}};