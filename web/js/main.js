window.onload=function(){AppJS.ready()};var AppJS={ready:function(){AppJS.handlers(),AppJS.sliderInit(),AppJS.deviceDetect(),AppJS.calculateSum(),$(".customScroll").mCustomScrollbar({scrollInertia:200,theme:"dark",scrollbarPosition:"outside"})},handlers:function(){$(".choiceMethod .methodItem").on("click",function(){AppJS.callMethod($(this))}),$(".showCallBack").on("click",function(){AppJS.switchCallBack()}),$(".callBackForm button").on("click",function(e){AppJS.ajaxSubmit(e,$(this))}),$(".gibBtn, .up").on("click",function(){AppJS.rotateSite()}),$(".changeControl").on("click",function(e){AppJS.changeControl(e,$(this))}),$(".status").on("click",function(){AppJS.changeItem($(this)),AppJS.calculateSum()}),$(".changeItem button").on("click",function(){AppJS.changeBtn($(this)),AppJS.calculateSum()}),$(".openPf").on("click",function(){AppJS.pfShow()}),$(".pfClose").on("click",function(){AppJS.pfHide()}),$(".overlay").on("click",function(){AppJS.hideModal()}),$(".calculate").on("keypress",function(e){AppJS.onlyPattern(e,$(this))}),$(".calculate").on("input",function(){AppJS.calculateSum()}),$("#select").on("change",function(){AppJS.calculateSum()}),window.onresize=function(){AppJS.deviceDetect()}},onlyPattern:function(e,a){var t=a.val()+String.fromCharCode(e.charCode),s=/^[0-9]*$/.test(t);(!s||t.length>5)&&e.preventDefault()},hideModal:function(){$(".show, .pfShow").removeClass("show pfShow")},ajaxSubmit:function(e,a){e.preventDefault();var t=a.closest("form").serializeArray(),s=$(".preLoader");s.show(),$.post("/mail.php",t,function(){AppJS.switchCallBack(),s.hide()})},sliderInit:function(){var e=Math.round($(".pfSlide").length/2)-1,a=new Swiper(".pfSlider",{slidesPerView:"auto",centeredSlides:!0,spaceBetween:-180,nextButton:".swiper-next",prevButton:".swiper-prev",initialSlide:e,breakpoints:{400:{spaceBetween:-50},650:{spaceBetween:-120}}});AppJS.sliderLevel(),a.on("SlideChangeStart",function(){AppJS.sliderLevel()})},sliderLevel:function(){$(".pfSlide").removeClass("level3 level4 level5");var e=$(".swiper-slide-next").next(),a=$(".swiper-slide-prev").prev(),t=e.next(),s=a.prev(),n=t.next(),i=s.prev();e.add(a).addClass("level3"),t.add(s).addClass("level4"),n.add(i).addClass("level5")},changeBtn:function(e){var a=e.closest(".changeItem").find(".status"),t=e.closest(".question"),s=a.closest(".catalog"),n=t.hasClass("onlinePay");e.hasClass("ok")?(n&&t.removeClass("noPay").addClass("pay"),e.closest(".design").find(".active").removeClass("active")):e.hasClass("no")&&n&&t.removeClass("pay").addClass("noPay"),s.removeClass("showQuestion"),setTimeout(function(){s.addClass("showQuestion")},10)},callMethod:function(e){var a=e.attr("data-target"),t=e.closest(".choiceMethod").find(".methodItem"),s=e.closest(".callBack").find("form");t.removeClass("active"),e.addClass("active"),s.attr("id","method"+(e.closest(".methodWrap").index()+1)),s.find("input").removeAttr("name").removeClass("submitField"),s.find("."+a).attr("name",a).addClass("submitField")},changeControl:function(e,a){$(e.target).closest(".question").length||($(".designType").removeClass("checked active"),a.addClass("checked active"),AppJS.calculateSum())},changeItem:function(e){var a=e.closest(".changeItem");a.find(".onlinePay").removeClass("pay noPay"),e.toggleClass("checked noChecked"),a.hasClass("catalog")&&a.toggleClass("showQuestion")},switchCallBack:function(){$(".callBack").toggleClass("show")},rotateSite:function(){$(".wrapper").toggleClass("rotate")},pfShow:function(){$(".portfolio").addClass("pfShow")},pfHide:function(){$(".portfolio").removeClass("pfShow")},calculateSum:function(){var e=$(".price span"),a=$(".deadline span"),t=0,s=0,n=$(".adaptive");if(n.hasClass("checked")){var i=n.attr("data-key");s+=params[i].time,t+=params[i].price}var l=$("#select").val();s+=params.engine[l].time,t+=params.engine[l].price;var o=$(".calculate");o.each(function(){var e=$(this).closest(".changeItem"),a=e.find(".status"),n=e.find(".individual");if(a.hasClass("checked")||$(this).hasClass("pageNum")&&n.hasClass("checked")){var i=$(this).attr("data-key"),l=+$(this).val();s+=params[i].time*l,t+=params[i].price*l}});var c=$(".status.checked:not(.noCalculate)");c.each(function(){var e=$(this).attr("data-key");s+=params[e].time,t+=params[e].price});var p=$(".onlinePay.pay");if(p.length){var r=p.attr("data-key");s+=params[r].time,t+=params[r].price}isNaN(t)||e.text(Math.round(t)+" руб."),isNaN(s)||a.text(Math.round(s)+" дней.")},deviceDetect:function(){var e=detect.parse(navigator.userAgent),a=e.device.family;AppJS.isBadBrowser="iPhone"===a||"iPad"===a,AppJS.appleStyle()},appleStyle:function(){var e=$("body"),a=$(".cube, .side");if(AppJS.isBadBrowser){var t=window.innerHeight;e.addClass("apple"),a.css({height:t})}else e.removeClass("apple"),a.css({height:"100vh"})}};