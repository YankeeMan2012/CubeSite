$(document).ready(function(){AppJS.ready()});var AppJS={ready:function(){AppJS.handlers(),AppJS.sliderInit(),AppJS.deviceDetect(),AppJS.calculateSum(),AppJS.initMask($("[data-mask]")),$(".customScroll").mCustomScrollbar({scrollInertia:200,theme:"dark",scrollbarPosition:"outside"});var a=location.hash;"#callback"===a?AppJS.showModal($(".callBack")):"#portfolio"===a?AppJS.showModal($(".portfolio")):"#recall"===a?AppJS.showModal($(".recall").closest(".navigationWrap")):"#about"===a&&AppJS.showModal($(".about").closest(".navigationWrap"))},handlers:function(){$("[data-required]").on("focusout",function(){ValidForm.checkRequiredVal(this)}),$("[data-pattern]").on("focusout",function(){ValidForm.checkFieldToPattern(this)}),$(".choiceMethod .methodItem").on("click",function(){AppJS.callMethod($(this))}),$(".callBackForm button").on("click",function(a){AppJS.ajaxSubmit(a,$(this))}),$(".gibBtn, .up").on("click",function(){$(".wrapper").toggleClass("rotate"),$("body").toggleClass("bottomAnimate")}),$(".changeControl").on("click",function(a){AppJS.changeControl(a,$(this))}),$(".status").on("click",function(){AppJS.changeItem($(this)),AppJS.calculateSum()}),$(".changeItem button").on("click",function(){AppJS.changeBtn($(this)),AppJS.calculateSum()}),$(".showCallBack").on("click",function(){AppJS.showModal($(".callBack"))}),$(".openPf").on("click",function(){AppJS.showModal($(".portfolio"))}),$(".openAbout").on("click",function(){AppJS.showModal($(".about").closest(".navigationWrap"))}),$(".openRecall").on("click",function(){AppJS.showModal($(".recall").closest(".navigationWrap"))}),$(".overlay, .closeModal, .pfClose").on("click",function(){AppJS.hideModal()}),$(".calculate, .pubInput, .logoField").on("keypress",function(a){AppJS.onlyPattern(a,$(this))}),$(".calculate, .pubInput, .logoField").on("input",function(){AppJS.calculateSum()}),$(".duplicate").on("input",function(){AppJS.duplicate($(this))}),$(".pubInput, .logoField").on("input",function(){AppJS.copyToDuplicate($(this))}),$("#select").on("change",function(){AppJS.calculateSum()}),window.onresize=function(){AppJS.deviceDetect()}},onlyPattern:function(a,e){var t=e.val()+String.fromCharCode(a.charCode),l=/^[0-9]*$/.test(t);(!l||t.length>5)&&a.preventDefault()},initMask:function(a){var e=a.attr("data-mask");a.mask(e)},showModal:function(a){$(".modalBox").addClass("above"),a.addClass("showModal")},hideModal:function(){$(".modalBox").removeClass("above"),$(".showModal").removeClass("showModal"),location.hash=""},ajaxSubmit:function(a,e){a.preventDefault();var t=ValidForm.validateField(e.siblings(".submitField"));if(t){var l=$(".preLoader");l.show();var o=e.closest("form").add(".calculatorForm"),i=o.serializeArray();$.post("/mail.php",i,function(){AppJS.hideModal($(".callBack")),l.hide()})}},sliderInit:function(){var a=Math.round($(".pfSlide").length/2)-1,e=new Swiper(".pfSlider",{slidesPerView:"auto",centeredSlides:!0,spaceBetween:-180,nextButton:".swiper-next",prevButton:".swiper-prev",initialSlide:a,loop:!0,breakpoints:{400:{spaceBetween:-50},650:{spaceBetween:-120}}});AppJS.sliderLevel(),e.on("SlideChangeStart",function(){AppJS.sliderLevel()}),new Swiper(".recall",{slidesPerView:1,loop:!0,speed:1e3,spaceBetween:300,nextButton:".nextSlide",prevButton:".prevSlide",centeredSlides:!0}),new Swiper(".textSlider",{slidesPerView:"auto",autoplay:2e3,loop:!0,speed:2e3})},sliderLevel:function(){$(".pfSlide").removeClass("level3 level4 level5");var a=$(".swiper-slide-next").next(),e=$(".swiper-slide-prev").prev(),t=a.next(),l=e.prev(),o=t.next(),i=l.prev();a.add(e).addClass("level3"),t.add(l).addClass("level4"),o.add(i).addClass("level5")},changeBtn:function(a){var e=a.closest(".changeItem").find(".status"),t=a.closest(".question"),l=e.closest(".questionBox"),o=t.hasClass("onlinePay");a.hasClass("ok")?(o&&t.removeClass("noPay").addClass("pay"),a.closest(".design").find(".active").removeClass("active")):a.hasClass("no")&&o&&t.removeClass("pay").addClass("noPay"),l.removeClass("showQuestion"),setTimeout(function(){l.addClass("showQuestion")},10)},callMethod:function(a){var e=a.attr("data-target"),t=a.closest(".choiceMethod").find(".methodItem"),l=a.closest(".callBack").find("form");t.removeClass("active"),a.addClass("active"),l.attr("id","method"+(a.closest(".methodWrap").index()+1)),l.find("input").removeAttr("name").removeClass("submitField").val(""),l.find("."+e).attr("name",e).addClass("submitField"),ValidForm.removeInvalid(l.find("."+e))},changeControl:function(a,e){$(a.target).closest(".question").length||($(".designType").removeClass("checked active"),e.addClass("checked active"),AppJS.calculateSum())},changeItem:function(a){var e=a.closest(".changeItem");e.find(".onlinePay").removeClass("pay noPay"),a.toggleClass("checked noChecked"),e.hasClass("questionBox")&&e.toggleClass("showQuestion")},copyToDuplicate:function(a){var e=a.val(),t=$("."+a.attr("data-duplicate"));t.val(e)},duplicate:function(a){var e=a.val(),t=$("."+a.attr("data-real"));t.val(e)},calculateSum:function(){var a=$(".price span"),e=$(".deadline span"),t=0,l=0,o=$(".adaptive");if(o.hasClass("checked")){var i=o.attr("data-key");l+=params[i].time,t+=params[i].price}var s=$("#select").val();l+=params.engine[s].time,t+=params.engine[s].price;var n=$(".calculate");n.each(function(){var a=$(this).closest(".changeItem"),e=a.find(".status"),o=a.find(".individual");if(e.hasClass("checked")||$(this).hasClass("pageNum")&&o.hasClass("checked")){var i=a.attr("data-key"),s=+$(this).val();l+=params[i].time*s,t+=params[i].price*s}});var c=$(".pubInput"),r=c.closest(".publication"),d=r.attr("data-key"),p=r.find(".publicNum").val(),u=r.find(".words").val();if(r.find(".status").hasClass("checked")){var v=+p*(+u/1e3);l+=params[d].time*v,t+=params[d].price*v}var h=$(".logoField"),m=h.closest(".logotype"),f=m.attr("data-key"),S=+m.find(".devLogo").val();m.find(".status").hasClass("checked")&&(l+=params[f].time*S,t+=params[f].price*S);var g=$(".status.checked:not(.noCalculate)");g.each(function(){var a=$(this).attr("data-key");l+=params[a].time,t+=params[a].price});var C=$(".onlinePay.pay");if(C.length){var k=C.attr("data-key");l+=params[k].time,t+=params[k].price}isNaN(t)||($(".priceInput").val(Math.round(t)),a.text(Math.round(t)+" руб.")),isNaN(l)||($(".deadlineInput").val(Math.round(l)),e.text(Math.round(l)+" дней."))},deviceDetect:function(){var a=detect.parse(navigator.userAgent),e=a.device.family,t=a.os.family;AppJS.isBadBrowser="iPhone"===e||"iPad"===e||"iOS"===t,AppJS.appleStyle()},appleStyle:function(){var a=$("body"),e=$(".cube, .side");if(AppJS.isBadBrowser){var t=window.innerHeight;a.addClass("apple"),e.css({height:t})}else a.removeClass("apple"),e.css({height:"100vh"})}},ValidForm={patterns:{email:/^\w+([\.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,4})+$/,skype:/^[a-zA-Z]{3,31}$/,whatsapp:/^\+?[0-9()]{5,31}$/},message:{emptyField:"Поле не может быть пустым",email:"Неверный формат Email",skype:"Неверный формат Skype",whatsapp:"Неверный формат WhatSapp"},getError:function(a){return'<p class="error">'+a+"</p>"},checkRequiredVal:function(a){var e=$(a).closest(".callBackForm");if(ValidForm.removeInvalid(a),""===$(a).val().trim()){var t=ValidForm.getError(ValidForm.message.emptyField);e.addClass("invalid").append(t)}},checkFieldToPattern:function(a){var e=$(a).closest(".callBackForm"),t=$(a).attr("data-pattern");if(!$(a).val())return!1;if(ValidForm.patterns[t].test($(a).val()))ValidForm.removeInvalid(a);else if(!e.hasClass("invalid")){var l=ValidForm.getError(ValidForm.message[t]);e.addClass("invalid").append(l)}},removeInvalid:function(a){$(a).closest(".invalid").removeClass("invalid").find("p.error").remove()},validateField:function(a){var e=!0;return ValidForm.removeInvalid(a),a.focusout(),a.closest(".invalid").length&&(e=!1),e}};