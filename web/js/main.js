$(document).ready(function(){AppJS.ready()});var AppJS={ready:function(){AppJS.handlers(),AppJS.sliderInit(),AppJS.deviceDetect(),AppJS.calculateSum(),$(".customScroll").mCustomScrollbar({scrollInertia:200,theme:"dark",scrollbarPosition:"outside"});var e=location.hash;"#callback"===e?AppJS.showModal($(".callBack")):"#portfolio"===e?AppJS.showModal($(".portfolio")):"#recall"===e?AppJS.showModal($(".recall").closest(".navigationWrap")):"#about"===e&&AppJS.showModal($(".about").closest(".navigationWrap"))},handlers:function(){$("[data-required]").on("focusout",function(){ValidForm.checkRequiredVal(this)}),$("[data-pattern]").on("focusout",function(){ValidForm.checkFieldToPattern(this)}),$(".choiceMethod .methodItem").on("click",function(){AppJS.callMethod($(this))}),$(".callBackForm button").on("click",function(e){AppJS.ajaxSubmit(e,$(this))}),$(".gibBtn, .up").on("click",function(){$(".wrapper").toggleClass("rotate"),$("body").toggleClass("bottomAnimate")}),$(".changeControl").on("click",function(e){AppJS.changeControl(e,$(this))}),$(".status").on("click",function(){AppJS.changeItem($(this)),AppJS.calculateSum()}),$(".changeItem button").on("click",function(){AppJS.changeBtn($(this)),AppJS.calculateSum()}),$(".showCallBack").on("click",function(){AppJS.showModal($(".callBack"))}),$(".openPf").on("click",function(){AppJS.showModal($(".portfolio"))}),$(".openAbout").on("click",function(){AppJS.showModal($(".about").closest(".navigationWrap"))}),$(".openRecall").on("click",function(){AppJS.showModal($(".recall").closest(".navigationWrap"))}),$(".overlay, .closeModal, .pfClose").on("click",function(){AppJS.hideModal()}),$(".calculate, .pubInput, .logoField").on("keypress",function(e){AppJS.onlyPattern(e,$(this))}),$(".calculate, .pubInput, .logoField").on("input",function(){AppJS.calculateSum()}),$(".duplicate").on("input",function(){AppJS.duplicate($(this))}),$(".pubInput, .logoField").on("input",function(){AppJS.copyToDuplicate($(this))}),$("#select").on("change",function(){AppJS.calculateSum()}),window.onresize=function(){AppJS.deviceDetect()}},onlyPattern:function(e,a){var t=a.val()+String.fromCharCode(e.charCode),l=/^[0-9]*$/.test(t);(!l||t.length>5)&&e.preventDefault()},showModal:function(e){$(".modalBox").addClass("above"),e.addClass("showModal")},hideModal:function(){$(".modalBox").removeClass("above"),$(".showModal").removeClass("showModal"),location.hash=""},ajaxSubmit:function(e,a){e.preventDefault();var t=ValidForm.validateField(a.siblings(".submitField"));if(t){var l=$(".preLoader");l.show();var o=a.closest("form").add(".calculatorForm"),s=o.serializeArray();$.post("/mail.php",s,function(){AppJS.hideModal($(".callBack")),AppJS.showModal($(".thanks")),l.hide()})}},sliderInit:function(){var e=Math.round($(".pfSlide").length/2)-1,a=new Swiper(".pfSlider",{slidesPerView:"auto",centeredSlides:!0,spaceBetween:-180,nextButton:".swiper-next",prevButton:".swiper-prev",initialSlide:e,loop:!0,breakpoints:{400:{spaceBetween:-50},650:{spaceBetween:-120}}});AppJS.sliderLevel(),a.on("SlideChangeStart",function(){AppJS.sliderLevel()}),new Swiper(".recall",{slidesPerView:1,loop:!0,speed:1e3,spaceBetween:300,nextButton:".nextSlide",prevButton:".prevSlide",centeredSlides:!0}),new Swiper(".textSlider",{slidesPerView:"auto",autoplay:2e3,loop:!0,speed:2e3})},sliderLevel:function(){$(".pfSlide").removeClass("level3 level4 level5");var e=$(".swiper-slide-next").next(),a=$(".swiper-slide-prev").prev(),t=e.next(),l=a.prev(),o=t.next(),s=l.prev();e.add(a).addClass("level3"),t.add(l).addClass("level4"),o.add(s).addClass("level5")},changeBtn:function(e){var a=e.closest(".changeItem").find(".status"),t=e.closest(".question"),l=a.closest(".questionBox"),o=t.hasClass("onlinePay");e.hasClass("ok")?(o&&t.removeClass("noPay").addClass("pay"),e.closest(".design").find(".active").removeClass("active")):e.hasClass("no")&&o&&t.removeClass("pay").addClass("noPay"),l.removeClass("showQuestion"),setTimeout(function(){l.addClass("showQuestion")},10)},callMethod:function(e){var a=e.attr("data-target"),t=e.closest(".choiceMethod").find(".methodItem"),l=e.closest(".callBack").find("form");t.removeClass("active"),e.addClass("active"),l.attr("id","method"+(e.closest(".methodWrap").index()+1)),l.find("input").removeAttr("name").removeClass("submitField").val(""),l.find("."+a).attr("name",a).addClass("submitField"),ValidForm.removeInvalid(l.find("."+a))},changeControl:function(e,a){$(e.target).closest(".question").length||($(".designType").removeClass("checked active"),a.addClass("checked active"),AppJS.calculateSum())},changeItem:function(e){var a=e.closest(".changeItem");a.find(".onlinePay").removeClass("pay noPay"),e.toggleClass("checked noChecked"),a.hasClass("questionBox")&&a.toggleClass("showQuestion")},copyToDuplicate:function(e){var a=e.val(),t=$("."+e.attr("data-duplicate"));t.val(a)},duplicate:function(e){var a=e.val(),t=$("."+e.attr("data-real"));t.val(a)},calculateSum:function(){var e=$(".price span"),a=$(".deadline span"),t=0,l=0,o=$(".adaptive");if(o.hasClass("checked")){var s=o.attr("data-key");l+=params[s].time,t+=params[s].price}var i=$("#select").val();l+=params.engine[i].time,t+=params.engine[i].price;var n=$(".calculate");n.each(function(){var e=$(this).closest(".changeItem"),a=e.find(".status"),o=e.find(".individual");if(a.hasClass("checked")||$(this).hasClass("pageNum")&&o.hasClass("checked")){var s=e.attr("data-key"),i=+$(this).val();l+=params[s].time*i,t+=params[s].price*i}});var c=$(".pubInput"),d=c.closest(".publication"),r=d.attr("data-key"),p=d.find(".publicNum").val(),u=d.find(".words").val();if(d.find(".status").hasClass("checked")){var v=+p*(+u/1e3);l+=params[r].time*v,t+=params[r].price*v}var h=$(".logoField"),m=h.closest(".logotype"),f=m.attr("data-key"),S=+m.find(".devLogo").val();m.find(".status").hasClass("checked")&&(l+=params[f].time*S,t+=params[f].price*S);var g=$(".status.checked:not(.noCalculate)");g.each(function(){var e=$(this).attr("data-key");l+=params[e].time,t+=params[e].price});var C=$(".onlinePay.pay");if(C.length){var w=C.attr("data-key");l+=params[w].time,t+=params[w].price}isNaN(t)||($(".priceInput").val(Math.round(t)),e.text(Math.round(t)+" руб.")),isNaN(l)||($(".deadlineInput").val(Math.round(l)),a.text(Math.round(l)+" дней."))},deviceDetect:function(){var e=detect.parse(navigator.userAgent),a=e.device.family,t=e.os.family;AppJS.isBadBrowser="iPhone"===a||"iPad"===a||"iOS"===t,AppJS.appleStyle()},appleStyle:function(){var e=$("body"),a=$(".cube, .side, .modalBox");if(AppJS.isBadBrowser){var t=window.innerHeight;e.addClass("apple"),a.css({height:t})}else e.removeClass("apple"),a.css({height:"100vh"})}},ValidForm={patterns:{email:/^\w+([\.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,4})+$/,skype:/^[a-zA-Z]{3,31}$/,whatsapp:/^\+?[\d]{1,3}(-|\s)?\(?[\d]{1,3}\)?(-|\s)?[\d](-|\s)?[\d](-|\s)?[\d](-|\s)?[\d](-|\s)?[\d](-|\s)?[\d](-|\s)?\d$/,mobile:/^\+?[\d]{1,3}(-|\s)?\(?[\d]{1,3}\)?(-|\s)?[\d](-|\s)?[\d](-|\s)?[\d](-|\s)?[\d](-|\s)?[\d](-|\s)?[\d](-|\s)?\d$/},message:{emptyField:"Поле не может быть пустым",email:"Неверный формат Email",skype:"Неверный формат Skype",whatsapp:"Неверный формат WhatSapp",mobile:"Неверный формат ntktajyf"},getError:function(e){return'<p class="error">'+e+"</p>"},checkRequiredVal:function(e){var a=$(e).closest(".callBackForm");if(ValidForm.removeInvalid(e),""===$(e).val().trim()){var t=ValidForm.getError(ValidForm.message.emptyField);a.addClass("invalid").append(t)}},checkFieldToPattern:function(e){var a=$(e).closest(".callBackForm"),t=$(e).attr("data-pattern");if(!$(e).val())return!1;var l=$(e).val();if(ValidForm.patterns[t].test(l))ValidForm.removeInvalid(e);else if(!a.hasClass("invalid")){var o=ValidForm.getError(ValidForm.message[t]);a.addClass("invalid").append(o)}},removeInvalid:function(e){$(e).closest(".invalid").removeClass("invalid").find("p.error").remove()},validateField:function(e){var a=!0;return ValidForm.removeInvalid(e),e.focusout(),e.closest(".invalid").length&&(a=!1),a}};